import{r as s,j as e,m as ye}from"./index-2b00a054.js";import{d as ve}from"./GridView-85d728d6.js";import{c as Te}from"./chidoanApi-461c2452.js";import"./index.esm-a80e06b2.js";import{u as Ce,C as Se}from"./index.esm-322da860.js";import{d as Pe}from"./Add-84462153.js";import{S as E}from"./react-select.esm-a86401bf.js";import"./Link-ed3a8026.js";import{c as ke}from"./canboApi-c8a721f9.js";import{d as z}from"./dayjs.min-51d44ca9.js";import{t as W}from"./thongkeApi-29f415fb.js";import"./TableChitietThiduathang-bb08c730.js";import{e as j,f as F,P as A,h as K,i as O,c as k,d as i,j as I,k as G,u as U,a as J,I as N,l as w,m as H,n as V,o as $}from"./LastPage-e02fc572.js";import{B as D}from"./Button-c283a03a.js";import{C as we,d as He}from"./FileDownload-3a33c116.js";import"./createSvgIcon-46c59fe3.js";import"./ButtonBase-ca61bcf9.js";function Q(h){const n=U(),{count:m,page:a,rowsPerPage:u,onPageChange:l}=h,f=t=>{l(t,0)},d=t=>{l(t,a-1)},r=t=>{l(t,a+1)},o=t=>{l(t,Math.max(0,Math.ceil(m/u)-1))};return e.jsxs(J,{sx:{flexShrink:0,ml:2.5},children:[e.jsx(N,{onClick:f,disabled:a===0,"aria-label":"first page",children:n.direction==="rtl"?e.jsx(w,{}):e.jsx(H,{})}),e.jsx(N,{onClick:d,disabled:a===0,"aria-label":"previous page",children:n.direction==="rtl"?e.jsx(V,{}):e.jsx($,{})}),e.jsx(N,{onClick:r,disabled:a>=Math.ceil(m/u)-1,"aria-label":"next page",children:n.direction==="rtl"?e.jsx($,{}):e.jsx(V,{})}),e.jsx(N,{onClick:o,disabled:a>=Math.ceil(m/u)-1,"aria-label":"last page",children:n.direction==="rtl"?e.jsx(H,{}):e.jsx(w,{})})]})}Q.propTypes={count:j.number.isRequired,onPageChange:j.func.isRequired,page:j.number.isRequired,rowsPerPage:j.number.isRequired};function Ve({list:h}){const[n,m]=s.useState(0),[a,u]=s.useState(10);n>0&&Math.max(0,(1+n)*a-h.length);const l=(d,r)=>{m(r)},f=d=>{u(parseInt(d.target.value,10)),m(0)};return e.jsxs(e.Fragment,{children:[e.jsx(F,{component:A,children:e.jsxs(K,{"aria-label":"custom pagination table",children:[e.jsx(O,{children:e.jsxs(k,{children:[e.jsx(i,{align:"left",rowSpan:2,style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(30, 41, 59 )"},children:"#"}),e.jsx(i,{align:"left",rowSpan:2,style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(30, 41, 59 )"},children:"Họ tên"}),e.jsx(i,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"100px",backgroundColor:"rgb(30, 41, 59 )"},children:"Ngày sinh"}),e.jsx(i,{align:"center",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"100px",backgroundColor:"rgb(30, 41, 59 )"},children:"Xếp loại đoàn viên năm"}),e.jsx(i,{align:"center",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"100px",backgroundColor:"rgb(30, 41, 59 )"},children:"Ghi chú"}),e.jsx(i,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"100px",backgroundColor:"rgb(30, 41, 59 )"},children:"Chi tiết"})]})}),e.jsx(I,{children:(a>0?h.slice(n*a,n*a+a):h).map((d,r)=>e.jsxs(k,{className:"hover:bg-slate-200 transition duration-300",children:[e.jsx(i,{className:"border-r border-slate-300",align:"left",style:{fontWeight:"bold"},children:n*a+r+1}),e.jsx(i,{className:"border-r border-slate-300",align:"left",children:e.jsx("span",{className:"font-bold",children:d.hoten})}),e.jsx(i,{className:"border-r border-slate-300",align:"left",children:z(d.ngaysinh).format("DD/MM/YYYY")}),e.jsx(i,{className:"border-r border-slate-300",children:d.result}),e.jsx(i,{className:"border-r border-slate-300",children:d.ghichu}),e.jsx(i,{className:"border-r border-slate-300",align:"right",children:e.jsx(D,{variant:"contained",color:"info",size:"small",onClick:()=>window.open(`/dashboard/thong-tin-doan-vien/${d._id}`,"_blank","noreferrer"),children:"Trang cá nhân"})})]},d._id))})]})}),e.jsx("div",{children:e.jsx(G,{rowsPerPageOptions:[10,25,50,100,{label:"Tất cả",value:-1}],count:h.length,rowsPerPage:a,page:n,SelectProps:{inputProps:{"aria-label":"rows per page"},native:!0},component:"div",onPageChange:l,onRowsPerPageChange:f,ActionsComponent:Q,labelRowsPerPage:"Số bản ghi hiển thị trên mỗi trang",labelDisplayedRows:function({from:r,to:o,count:t}){return`hiển thị ${r} đến ${o} bản ghi trong tổng số ${t!==-1?t:`more than ${o}`} bản ghi`}})})]})}let $e=[{label:"STT",key:"stt"},{label:"Họ tên",key:"hoten"},{label:"Ngày sinh",key:"ngaysinh"},{label:"Số lượt",key:"soluot"},{label:"Thời gian",key:"thoigians"}];function Z(h){const n=U(),{count:m,page:a,rowsPerPage:u,onPageChange:l}=h,f=t=>{l(t,0)},d=t=>{l(t,a-1)},r=t=>{l(t,a+1)},o=t=>{l(t,Math.max(0,Math.ceil(m/u)-1))};return e.jsxs(J,{sx:{flexShrink:0,ml:2.5},children:[e.jsx(N,{onClick:f,disabled:a===0,"aria-label":"first page",children:n.direction==="rtl"?e.jsx(w,{}):e.jsx(H,{})}),e.jsx(N,{onClick:d,disabled:a===0,"aria-label":"previous page",children:n.direction==="rtl"?e.jsx(V,{}):e.jsx($,{})}),e.jsx(N,{onClick:r,disabled:a>=Math.ceil(m/u)-1,"aria-label":"next page",children:n.direction==="rtl"?e.jsx($,{}):e.jsx(V,{})}),e.jsx(N,{onClick:o,disabled:a>=Math.ceil(m/u)-1,"aria-label":"last page",children:n.direction==="rtl"?e.jsx(H,{}):e.jsx(w,{})})]})}Z.propTypes={count:j.number.isRequired,onPageChange:j.func.isRequired,page:j.number.isRequired,rowsPerPage:j.number.isRequired};function S({list:h,title:n,excelExport:m}){const[a,u]=s.useState(0),[l,f]=s.useState(10);a>0&&Math.max(0,(1+a)*l-h.length);const d=(o,t)=>{u(t)},r=o=>{f(parseInt(o.target.value,10)),u(0)};return e.jsxs("div",{className:"px-4","data-aos":"fade-left","data-aos-once":"true",children:[e.jsx("div",{className:"my-4 text-right",children:e.jsx(D,{color:"info",variant:"contained",size:"small",children:e.jsx(we,{data:m,headers:$e,filename:n,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(He,{}),e.jsx("span",{className:"text-sm",children:"Xuất file excel"})]})})})}),e.jsx(F,{component:A,children:e.jsxs(K,{"aria-label":"custom pagination table",children:[e.jsx(O,{children:e.jsxs(k,{children:[e.jsx(i,{align:"left",rowSpan:2,style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(30, 41, 59 )"},children:"#"}),e.jsx(i,{align:"left",rowSpan:2,style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(30, 41, 59 )"},children:"Họ tên"}),e.jsx(i,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"100px",backgroundColor:"rgb(30, 41, 59 )"},children:"Ngày sinh"}),e.jsx(i,{align:"center",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"100px",backgroundColor:"rgb(30, 41, 59 )"},children:"Số lượt"}),e.jsx(i,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"100px",backgroundColor:"rgb(30, 41, 59 )"},children:"Chi tiết"})]})}),e.jsx(I,{children:(l>0?h.slice(a*l,a*l+l):h).map((o,t)=>e.jsxs(k,{className:"hover:bg-slate-200 transition duration-300",children:[e.jsx(i,{className:"border-r border-slate-300",align:"left",style:{fontWeight:"bold"},children:a*l+t+1}),e.jsx(i,{className:"border-r border-slate-300",align:"left",children:e.jsx("span",{className:"font-bold",children:o.hoten})}),e.jsx(i,{className:"border-r border-slate-300",align:"left",children:z(o.ngaysinh).format("DD/MM/YYYY")}),e.jsxs(i,{className:"border-r border-slate-300",children:[o.soluot," lượt ",e.jsxs("span",{className:"font-bold",children:["(",o.thoigians.toString(),")"]})]}),e.jsx(i,{className:"border-r border-slate-300",align:"right",children:e.jsx(D,{variant:"contained",color:"info",size:"small",onClick:()=>window.open(`/dashboard/thong-tin-doan-vien/${o._id}`,"_blank","noreferrer"),children:"Trang cá nhân"})})]},o._id))})]})}),e.jsx("div",{children:e.jsx(G,{rowsPerPageOptions:[10,25,50,100,{label:"Tất cả",value:-1}],count:h.length,rowsPerPage:l,page:a,SelectProps:{inputProps:{"aria-label":"rows per page"},native:!0},component:"div",onPageChange:d,onRowsPerPageChange:r,ActionsComponent:Z,labelRowsPerPage:"Số bản ghi hiển thị trên mỗi trang",labelDisplayedRows:function({from:t,to:T,count:g}){return`hiển thị ${t} đến ${T} bản ghi trong tổng số ${g!==-1?g:`more than ${T}`} bản ghi`}})})]})}const P=h=>h.map(n=>({hoten:n.hoten,ngaysinh:z(n.ngaysinh).format("DD/MM/YYYY"),soluot:n.soluot,thoigians:n.thoigians.toString()})),Je=()=>{const[h,n]=s.useState(0),[m,a]=s.useState(0),[u,l]=ye(),[f,d]=s.useState([]),[r,o]=s.useState({label:"",value:""}),[t,T]=s.useState(!1);s.useState([]);const[g,X]=s.useState(0),[ee,ae]=s.useState([]),[ne,te]=s.useState([]),[C,se]=s.useState(""),[le,L]=s.useState([]),[B,ie]=s.useState([]),[R,re]=s.useState([]),[_,oe]=s.useState([]),[M,de]=s.useState([]),[ce,he]=s.useState(!1),[xe,me]=s.useState(!1),[ue,pe]=s.useState(!1),[fe,ge]=s.useState(!1),{register:Y,handleSubmit:be,control:je,resetField:De,setValue:q,watch:b,formState:{errors:Be}}=Ce({defaultValues:{chidoans:{label:"Tất cả",value:""},tunam:"",dennam:"",hoten:""}});s.useEffect(()=>{(async()=>{try{let c=await ke.fetchYearMonth(),p=await Te.getChidoanOfUser();d([{label:"Tất cả",value:""}].concat(p.data.map(y=>({value:y._id,label:y.tenchidoan})))),q("tunam",c.data.year-1),q("dennam",c.data.year-1),X(c.data.year-1);let v=[];for(let y=c.data.year-1;y>=2020;y--)v.push({label:y,value:y});ae(v),n(c.data.year-1),a(c.data.year-1)}catch(c){console.log(c.message)}})()},[]);const Ne=async x=>{let c={...x,chidoans:x.chidoans.value};try{let p=await W.getThiduanams(c);n(x.tunam),a(x.dennam),o(x.chidoans),ie(p.data.dataKHTNV),re(p.data.dataHTNV),oe(p.data.dataHTTNV),de(p.data.dataHTXSNV),T(!0)}catch(p){console.log(p.message)}};return s.useEffect(()=>{g!==0&&(async()=>{l(!0);try{let c=await W.getBangThiduanams({year:g,chidoans:r.value}),p=c.data.filter(v=>v.hoten.toLowerCase().includes(C.toLowerCase()));te(c.data),console.log(c.data),L(p),l(!1)}catch(c){console.log(c.message)}})()},[g,r]),s.useEffect(()=>{let x=[...ne];if(x.length>0){const c=setTimeout(()=>{let p=x.filter(v=>v.hoten.toLowerCase().includes(C.toLowerCase()));L(p)},500);return()=>clearTimeout(c)}},[C]),e.jsxs("div",{className:"pr-2","data-aos":"fade-left","data-aos-once":"true",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ve,{color:"primary",fontSize:"large"}),e.jsxs("h4",{className:"font-bold text-gray-800 text-lg",children:["Theo dõi, thống kê xếp loại đoàn viên từ năm ",h," đến năm ",m," - chi đoàn, liên chi đoàn: ",r==null?void 0:r.label]})]}),e.jsx("form",{onSubmit:be(Ne),children:e.jsxs("div",{className:"flex flex-col mt-4 px-4 md:flex-row md:flex-wrap justify-end items-start",children:[e.jsxs("div",{className:"flex-col md:basis-1/3 flex flex-1 px-1 w-full",children:[e.jsx("label",{className:"underline font-semibold",children:"Họ tên: "}),e.jsx("input",{...Y("hoten"),type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                    focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex-col md:basis-1/6 flex flex-1 px-1 w-full",children:[e.jsx("label",{className:"underline font-semibold",children:"Từ năm: "}),e.jsx("input",{...Y("tunam"),type:"number",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex-col md:basis-1/6 flex flex-1 px-1 w-full",children:[e.jsx("label",{className:"underline font-semibold",children:"Đến năm: "}),e.jsx("input",{...Y("dennam"),type:"number",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex-col md:basis-1/6 flex flex-1 px-1 w-full",children:[e.jsx("label",{className:"underline font-semibold",children:"Chi đoàn, liên chi đoàn: "}),e.jsx(Se,{control:je,name:"chidoans",render:({field:x})=>e.jsx(E,{options:f,className:"basic-multi-select my-4 p-1",classNamePrefix:"select",placeholder:"Tất cả",...x})})]}),e.jsx("div",{className:"flex-col fle md:basis-1/6 px-1",children:e.jsxs(D,{size:"small",type:"submit",sx:{width:"220px",backgroundColor:"gray"},color:"primary",variant:"contained",children:[e.jsx(Pe,{})," Lấy dữ liệu"]})})]})}),t&&e.jsxs("div",{className:"px-4","data-aos":"fade-left","data-aos-once":"true",children:[e.jsx("h3",{className:"font-bold",children:"Thống kê chi tiết xếp loại đoàn viên năm: "}),e.jsxs("div",{className:"pl-8 mb-8",children:[e.jsxs("div",{className:"font-arial text-black",children:[' - Số đoàn viên xếp loại thi đua "Không hoàn thành nhiệm vụ": ',e.jsx("span",{className:"text-xl font-bold",children:B.length})," đoàn viên. ",e.jsx("span",{className:"cursor-pointer underline text-blue-700",onClick:()=>he(!0),children:"Xem chi tiết"})]}),ce&&e.jsx(S,{title:`KHTNV_${b("tunam")}_${b("dennam")}`,excelExport:P(B),list:B}),e.jsxs("div",{className:"font-arial text-black",children:[' - Số đoàn viên xếp loại thi đua "Hoàn thành nhiệm vụ": ',e.jsx("span",{className:"text-xl font-bold",children:R.length})," đoàn viên. ",e.jsx("span",{className:"cursor-pointer underline text-blue-700",onClick:()=>me(!0),children:"Xem chi tiết"})]}),xe&&e.jsx(S,{title:`HTNV_${b("tunam")}_${b("dennam")}`,excelExport:P(R),list:R}),e.jsxs("div",{className:"font-arial text-black",children:[' - Số đoàn viên xếp loại thi đua "Hoàn thành tốt nhiệm vụ": ',e.jsx("span",{className:"text-xl font-bold",children:_.length})," đoàn viên. ",e.jsx("span",{className:"cursor-pointer underline text-blue-700",onClick:()=>pe(!0),children:"Xem chi tiết"})]}),ue&&e.jsx(S,{title:`HTTNV_${b("tunam")}_${b("dennam")}`,excelExport:P(_),list:_}),e.jsxs("div",{className:"font-arial text-black",children:[' - Số đoàn viên xếp loại thi đua "Hoàn thành xuất sắc nhiệm vụ": ',e.jsx("span",{className:"text-xl font-bold",children:M.length})," đoàn viên. ",e.jsx("span",{className:"cursor-pointer underline text-blue-700",onClick:()=>ge(!0),children:"Xem chi tiết"})]}),fe&&e.jsx(S,{title:`HTXSNV_${b("tunam")}_${b("dennam")}`,excelExport:P(M),list:M})]}),e.jsx("div",{className:"mt-4"})]}),e.jsxs("div",{className:"px-4",children:[e.jsxs("h3",{className:"text-center mt-4 font-mono text-xl font-bold",children:["Bảng theo dõi xếp loại đoàn viên năm ",g," - ",r==null?void 0:r.label]}),e.jsxs("div",{className:"flex flex-col space-x-2 md:flex-row justify-end items-center",children:[e.jsxs("div",{className:"flex-col md:basis-1/3 flex  px-1 w-full",children:[e.jsx("label",{className:"underline font-semibold",children:"Họ tên: "}),e.jsx("input",{value:C,name:"search",onChange:x=>se(x.target.value),type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                    focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex-col flex w-full md:w-auto",children:[e.jsx("label",{className:"underline font-semibold",children:"Tùy chỉnh năm để lấy dữ liệu:"}),e.jsx(E,{value:{label:g,value:g},required:!0,name:"year",options:ee,className:"basic-multi-select my-4",classNamePrefix:"select",onChange:x=>X(x.value)})]})]}),e.jsx("div",{children:e.jsx(Ve,{list:le})})]})]})};export{Je as default};
