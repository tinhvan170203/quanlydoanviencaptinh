import{r as x,d as _,j as e,u as M,m as V,Q as y}from"./index-2b00a054.js";import{d as W}from"./GridView-85d728d6.js";import"./index.esm-a80e06b2.js";import{u as R}from"./index.esm-322da860.js";import{d as q}from"./Add-84462153.js";import{f as A,g as I,S as Q,D as K,a as G,h as J,d as U,b as X,c as Y,e as Z}from"./DialogDelete-f919c647.js";import{c as S,d as u,e as N,f as ee,P as se,h as ae,i as te,j as le,k as re,u as ne,a as $,I as C,l as T,m as B,n as w,o as O}from"./LastPage-e02fc572.js";import{B as P}from"./Button-c283a03a.js";import{b as v}from"./bachamApi-b2e350fc.js";import{s as oe}from"./ButtonBase-ca61bcf9.js";import"./createSvgIcon-46c59fe3.js";const ie=({row:l,page:a,rowsPerPage:i,index:s,onClickOpenDialogEdit:n,onClickOpenDialogDelete:t})=>{x.useState(null);const c=_(p=>p.authReducer.roles_quanlydoanvien);return e.jsxs(S,{className:"hover:bg-slate-200 transition duration-300",children:[e.jsx(u,{className:"border-r border-slate-300",align:"left",style:{fontWeight:"bold"},children:a*i+s}),e.jsx(u,{className:"border-r border-slate-300",align:"left",children:l.bacham}),e.jsx(u,{className:"border-r border-slate-300",align:"left",children:l.nienhan}),e.jsx(u,{className:"border-r border-slate-300",align:"left",children:l.thutu}),e.jsxs(u,{align:"right",className:"bg-gray-300 flex justify-center items-center space-x-1 hover:bg-slate-500 transition duration-300",style:{width:"180px"},children:[c&&c.includes("sửa bậc hàm")&&e.jsx(P,{variant:"contained",color:"info",size:"small",onClick:()=>n(l),children:e.jsx(A,{style:{fontSize:"20px"}})}),c&&c.includes("xóa bậc hàm")&&e.jsx(P,{variant:"contained",color:"error",size:"small",style:{marginLeft:"4px"},onClick:()=>t(l._id),children:e.jsx(I,{style:{fontSize:"20px"}})})]})]},l._id)};function z(l){const a=ne(),{count:i,page:s,rowsPerPage:n,onPageChange:t}=l,c=r=>{t(r,0)},p=r=>{t(r,s-1)},d=r=>{t(r,s+1)},h=r=>{t(r,Math.max(0,Math.ceil(i/n)-1))};return e.jsxs($,{sx:{flexShrink:0,ml:2.5},children:[e.jsx(C,{onClick:c,disabled:s===0,"aria-label":"first page",children:a.direction==="rtl"?e.jsx(T,{}):e.jsx(B,{})}),e.jsx(C,{onClick:p,disabled:s===0,"aria-label":"previous page",children:a.direction==="rtl"?e.jsx(w,{}):e.jsx(O,{})}),e.jsx(C,{onClick:d,disabled:s>=Math.ceil(i/n)-1,"aria-label":"next page",children:a.direction==="rtl"?e.jsx(O,{}):e.jsx(w,{})}),e.jsx(C,{onClick:h,disabled:s>=Math.ceil(i/n)-1,"aria-label":"last page",children:a.direction==="rtl"?e.jsx(B,{}):e.jsx(T,{})})]})}z.propTypes={count:N.number.isRequired,onPageChange:N.func.isRequired,page:N.number.isRequired,rowsPerPage:N.number.isRequired};function de({list:l,onClickOpenDialogEdit:a,onClickOpenDialogDelete:i}){const[s,n]=x.useState(0),[t,c]=x.useState(10),p=s>0?Math.max(0,(1+s)*t-l.length):0,d=(r,g)=>{n(g)},h=r=>{c(parseInt(r.target.value,10)),n(0)};return e.jsxs(e.Fragment,{children:[e.jsx(ee,{component:se,children:e.jsxs(ae,{"aria-label":"custom pagination table",children:[e.jsx(te,{children:e.jsxs(S,{children:[e.jsx(u,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(30, 41, 59 )"},children:"#"}),e.jsx(u,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(30, 41, 59 )"},children:"Cấp bậc hàm"}),e.jsx(u,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(30, 41, 59 )"},children:"Niên hạn"}),e.jsx(u,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"100px",backgroundColor:"rgb(30, 41, 59 )"},children:"Thứ tự"}),e.jsx(u,{align:"center",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(30, 41, 59 )",maxWidth:"150px"},children:"Thao tác"})]})}),e.jsxs(le,{children:[(t>0?l.slice(s*t,s*t+t):l).map((r,g)=>e.jsx(ie,{row:r,page:s,rowsPerPage:t,index:g+1,onClickOpenDialogEdit:a,onClickOpenDialogDelete:i},r._id)),p>0&&e.jsx(S,{style:{height:53*p},children:e.jsx(u,{colSpan:6})})]})]})}),e.jsx("div",{children:e.jsx(re,{rowsPerPageOptions:[10,25,50,100,{label:"Tất cả",value:-1}],count:l.length,rowsPerPage:t,page:s,SelectProps:{inputProps:{"aria-label":"rows per page"},native:!0},component:"div",onPageChange:d,onRowsPerPageChange:h,ActionsComponent:z,labelRowsPerPage:"Số bản ghi hiển thị trên mỗi trang",labelDisplayedRows:function({from:g,to:f,count:m}){return`hiển thị ${g} đến ${f} bản ghi trong tổng số ${m!==-1?m:`more than ${f}`} bản ghi`}})})]})}const ce=x.forwardRef(function(a,i){return e.jsx(Q,{direction:"up",ref:i,...a})}),ue=oe(C)({position:"absolute",right:"16px",top:"4px"});function he({open:l,item:a,onCloseDialogEdit:i,onSubmit:s}){const{register:n,handleSubmit:t,control:c,resetField:p,setValue:d,watch:h,formState:{errors:r}}=R({defaultValues:{bacham:"",nienhan:2,thutu:1,status:!0}});x.useState([]),x.useEffect(()=>{a&&(d("bacham",a.bacham,{shouldValidate:!0}),d("nienhan",a.nienhan,{shouldValidate:!0}),d("thutu",a.thutu,{shouldValidate:!0}))},[a]);const g=async f=>{if(s){const m={...f,id_edit:a._id};await s(m),i()}};return e.jsx(e.Fragment,{children:e.jsxs(K,{maxWidth:"lg",fullWidth:!0,disableEscapeKeyDown:!0,onClose:(f,m)=>{m!=="backdropClick"&&i(f,m)},open:l,TransitionComponent:ce,keepMounted:!0,"aria-describedby":"alert-dialog-slide-description",children:[e.jsxs(G,{style:{display:"flex",borderBottom:"1px solid #ccc",backgroundColor:"rgb(30, 41, 59 )",margin:"0px"},children:[e.jsx(J,{style:{color:"white",fontSize:"24px",marginRight:"8px"}}),e.jsx("span",{className:"text-white text-[18px]",children:"Chỉnh sửa bậc hàm"}),e.jsx(ue,{onClick:()=>i(),children:e.jsx(U,{style:{color:"white"}})})]}),e.jsx(X,{children:e.jsx($,{children:e.jsxs("form",{className:"mt-2 mx-8",onSubmit:t(g),children:[e.jsxs("div",{className:"flex-col flex",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Cấp bậc: "]}),e.jsx("input",{...n("bacham",{required:!0}),type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Niên hạn lên bậc hàm tiếp theo tính theo năm: "]}),e.jsx("input",{...n("nienhan",{required:!0}),type:"number",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Thứ tự xuất hiện: "]}),e.jsx("input",{...n("thutu",{required:!0}),type:"number",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]})]}),e.jsx(Y,{children:e.jsxs(P,{color:"primary",variant:"contained",type:"submit",style:{margin:"4px auto"},children:[e.jsx(q,{}),e.jsx("span",{children:"Cập nhật"})]})})]})})})]})})}const Se=()=>{const[l,a]=x.useState([]);M();const[i,s]=V(),[n,t]=x.useState({status:!1,item:null}),c=()=>{t({...n,status:!1})},p=o=>{t({item:o,status:!0})},[d,h]=x.useState({status:!1,id_Delete:null}),r=o=>{h({status:!0,id_Delete:o})},g=()=>{h({...d,status:!1})},f=()=>{h({...d,status:!1})},m=_(o=>o.authReducer.roles_quanlydoanvien),{register:D,handleSubmit:E,control:me,resetField:k,watch:xe,formState:{errors:pe}}=R({defaultValues:{bacham:"",thutu:1,nienhan:2}});x.useEffect(()=>{(async()=>{try{s(!0);let j=await v.getBachams();a(j.data),setTimeout(()=>{s(!1)},400)}catch(j){console.log(j.message)}})()},[]);const F=async o=>{let j={...o};s(!0);try{let b=await v.addBacham(j);a(b.data.bachamList),setTimeout(()=>{s(!1)},400),k("bacham"),k("nienhan"),k("thutu"),y.success(b.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}catch(b){y.error(b.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),s(!1)}},H=async o=>{let j={...o};s(!0);try{let b=await v.editBacham(j);a(b.data.bachamList),setTimeout(()=>{s(!1)},400),y.success(b.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}catch(b){y.error(b.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),s(!1)}},L=async()=>{s(!0);try{let o=await v.deleteBacham(d.id_Delete);a(o.data.bachamList),setTimeout(()=>{s(!1)},400),h({...d,status:!1}),y.success(o.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}catch(o){h({...d,status:!1}),y.error(o.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),s(!1)}};return e.jsxs("div",{className:"pr-2","data-aos":"fade-left","data-aos-once":"true",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(W,{color:"primary",fontSize:"large"}),e.jsx("h4",{className:"font-bold text-gray-800 text-lg",children:"Quản lý Bậc quân hàm"})]}),m&&m.includes("thêm bậc hàm")&&e.jsxs("form",{className:"mt-2 mx-8",onSubmit:E(F),children:[e.jsxs("div",{className:"flex-col flex",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Tên cấp bậc hàm: "]}),e.jsx("input",{...D("bacham",{required:!0}),type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Niên hạn lên hàm tiếp theo: "]}),e.jsx("input",{...D("nienhan",{required:!0}),type:"number",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Thứ tự: "]}),e.jsx("input",{...D("thutu",{required:!0}),type:"number",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]})]}),e.jsx("div",{className:"md:space-x-2 space-y-2 md:space-y-0 md:block flex flex-col items-center",children:e.jsxs(P,{type:"submit",sx:{width:"220px",backgroundColor:"gray"},color:"primary",variant:"contained",children:[e.jsx(q,{})," Thêm mới"]})})]}),e.jsx("div",{className:"mt-6 mx-8",children:e.jsx(de,{list:l,onClickOpenDialogDelete:r,onClickOpenDialogEdit:p})}),e.jsx(he,{open:n.status,item:n.item,onCloseDialogEdit:c,onSubmit:H}),e.jsx(Z,{open:d.status,onCloseDialogDelete:f,onConfirmDelete:L,onCancelDelete:g})]})};export{Se as default};
