import{r as b,j as e,d as M,m as X,u as Y,Q as w}from"./index-2b00a054.js";import{d as Z}from"./GridView-85d728d6.js";import"./index.esm-a80e06b2.js";import{u as F,C as H}from"./index.esm-322da860.js";import{d as V}from"./Add-84462153.js";import{f as ee,g as ne,S as ae,D as se,a as te,h as le,d as oe,b as re,c as ie,e as ce}from"./DialogDelete-f919c647.js";import{r as D}from"./roleApi-b4c7a90e.js";import{c as Q,d as p,e as L,f as he,P as de,h as me,i as ue,j as xe,k as ge,u as fe,a as A,I as T,l as B,m as E,n as z,o as $}from"./LastPage-e02fc572.js";import{B as S}from"./Button-c283a03a.js";import{S as I}from"./Switch-39e410f5.js";import{s as pe}from"./ButtonBase-ca61bcf9.js";import"./createSvgIcon-46c59fe3.js";const m=({label:c,values:a,onChangeRoleList:g,roleNow:n})=>{const[h,o]=b.useState([]);b.useEffect(()=>{o(a)},[]),b.useEffect(()=>{if(n){let s=[];a.forEach(r=>{n.includes(r.name)?s.push({name:r.name,isChecked:!0}):s.push({name:r.name,isChecked:!1})}),o(s)}else o(a)},[n]);const f=s=>{const{name:r,checked:j}=s.target;if(r==="allSelect"){let i=h.map(t=>({...t,isChecked:j}));o(i);let l=[],k=[];i.forEach(t=>{t.isChecked===!0?l.push(t.name):k.push(t.name)}),g(l,k)}else{let i=h.map(t=>t.name===r?{...t,isChecked:j}:t);o(i);let l=[],k=[];i.forEach(t=>{t.isChecked===!0?l.push(t.name):k.push(t.name)}),g(l,k)}};return e.jsxs("div",{className:"my-2 lg:basis-1/2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"",children:["Nhóm chức năng: ",e.jsx("span",{className:" font-semibold",children:c})]}),e.jsx("input",{className:"w-5 h-5",type:"checkbox",checked:h.filter(s=>(s==null?void 0:s.isChecked)!==!0).length<1,name:"allSelect",value:"allSelect",onChange:f})]}),h&&h.map((s,r)=>e.jsxs("div",{className:"flex items-center space-x-2 ml-2",children:[e.jsx("input",{className:"w-4 h-4",type:"checkbox",checked:(s==null?void 0:s.isChecked)||!1,name:s.name,onChange:f}),e.jsx("label",{children:s.name})]},s.name))]})},be=({row:c,page:a,rowsPerPage:g,index:n,onClickOpenDialogEdit:h,onClickOpenDialogDelete:o})=>{b.useState(null);const f=M(s=>s.authReducer.roles_quanlydoanvien);return e.jsxs(Q,{className:"hover:bg-slate-200 transition duration-300",children:[e.jsx(p,{className:"border-r border-slate-300",align:"left",style:{fontWeight:"bold"},children:a*g+n}),e.jsx(p,{className:"border-r border-slate-300",align:"left",children:c.tennhom}),e.jsx(p,{className:"border-r border-slate-300",align:"left",children:c.mota}),e.jsx(p,{className:"border-r border-slate-300",align:"left",children:c.roles.map(s=>e.jsxs("span",{children:[s,", "]},s))}),e.jsx(p,{className:"border-r border-slate-300",align:"left",children:c.thutu}),e.jsx(p,{className:"border-r border-slate-300",align:"left",children:c.status===!0?e.jsx(S,{color:"success",children:"Đang hiển thị"}):e.jsx(S,{color:"warning",children:"Không hiển thị"})}),e.jsxs(p,{align:"right",className:"bg-gray-300 flex justify-center items-center space-x-1 hover:bg-slate-500 transition duration-300",style:{width:"180px"},children:[f&&f.includes("sửa nhóm quyền")&&e.jsx(S,{variant:"contained",color:"info",size:"small",onClick:()=>h(c),children:e.jsx(ee,{style:{fontSize:"20px"}})}),f&&f.includes("xóa nhóm quyền")&&e.jsx(S,{variant:"contained",color:"error",size:"small",style:{marginLeft:"4px"},onClick:()=>o(c._id),children:e.jsx(ne,{style:{fontSize:"20px"}})})]})]},c._id)};function W(c){const a=fe(),{count:g,page:n,rowsPerPage:h,onPageChange:o}=c,f=i=>{o(i,0)},s=i=>{o(i,n-1)},r=i=>{o(i,n+1)},j=i=>{o(i,Math.max(0,Math.ceil(g/h)-1))};return e.jsxs(A,{sx:{flexShrink:0,ml:2.5},children:[e.jsx(T,{onClick:f,disabled:n===0,"aria-label":"first page",children:a.direction==="rtl"?e.jsx(B,{}):e.jsx(E,{})}),e.jsx(T,{onClick:s,disabled:n===0,"aria-label":"previous page",children:a.direction==="rtl"?e.jsx(z,{}):e.jsx($,{})}),e.jsx(T,{onClick:r,disabled:n>=Math.ceil(g/h)-1,"aria-label":"next page",children:a.direction==="rtl"?e.jsx($,{}):e.jsx(z,{})}),e.jsx(T,{onClick:j,disabled:n>=Math.ceil(g/h)-1,"aria-label":"last page",children:a.direction==="rtl"?e.jsx(E,{}):e.jsx(B,{})})]})}W.propTypes={count:L.number.isRequired,onPageChange:L.func.isRequired,page:L.number.isRequired,rowsPerPage:L.number.isRequired};function je({list:c,onClickOpenDialogEdit:a,onClickOpenDialogDelete:g}){const[n,h]=b.useState(0),[o,f]=b.useState(10),s=n>0?Math.max(0,(1+n)*o-c.length):0,r=(i,l)=>{h(l)},j=i=>{f(parseInt(i.target.value,10)),h(0)};return e.jsxs(e.Fragment,{children:[e.jsx(he,{component:de,children:e.jsxs(me,{"aria-label":"custom pagination table",children:[e.jsx(ue,{children:e.jsxs(Q,{children:[e.jsx(p,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(30, 41, 59 )"},children:"#"}),e.jsx(p,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(30, 41, 59 )"},children:"Tên nhóm quyền"}),e.jsx(p,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(30, 41, 59 )"},children:"Mô tả"}),e.jsx(p,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(30, 41, 59 )"},children:"Quyền chi tiết"}),e.jsx(p,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"100px",backgroundColor:"rgb(30, 41, 59 )"},children:"Thứ tự"}),e.jsx(p,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"200px",backgroundColor:"rgb(30, 41, 59 )"},children:"Trạng thái hiển thị"}),e.jsx(p,{align:"center",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(30, 41, 59 )",maxWidth:"150px"},children:"Thao tác"})]})}),e.jsxs(xe,{children:[(o>0?c.slice(n*o,n*o+o):c).map((i,l)=>e.jsx(be,{row:i,page:n,rowsPerPage:o,index:l+1,onClickOpenDialogEdit:a,onClickOpenDialogDelete:g},i._id)),s>0&&e.jsx(Q,{style:{height:53*s},children:e.jsx(p,{colSpan:6})})]})]})}),e.jsx("div",{children:e.jsx(ge,{rowsPerPageOptions:[10,25,50,100,{label:"Tất cả",value:-1}],count:c.length,rowsPerPage:o,page:n,SelectProps:{inputProps:{"aria-label":"rows per page"},native:!0},component:"div",onPageChange:r,onRowsPerPageChange:j,ActionsComponent:W,labelRowsPerPage:"Số bản ghi hiển thị trên mỗi trang",labelDisplayedRows:function({from:l,to:k,count:t}){return`hiển thị ${l} đến ${k} bản ghi trong tổng số ${t!==-1?t:`more than ${k}`} bản ghi`}})})]})}const ke=b.forwardRef(function(a,g){return e.jsx(ae,{direction:"up",ref:g,...a})}),Ce=pe(T)({position:"absolute",right:"16px",top:"4px"});function ye({open:c,item:a,onCloseDialogEdit:g,onSubmit:n}){const{register:h,handleSubmit:o,control:f,resetField:s,setValue:r,watch:j,formState:{errors:i}}=F({defaultValues:{tennhom:"",mota:"",thutu:1,status:!0}}),[l,k]=b.useState([]);b.useEffect(()=>{a&&(r("tennhom",a.tennhom,{shouldValidate:!0}),r("mota",a.mota,{shouldValidate:!0}),r("thutu",a.thutu,{shouldValidate:!0}),r("status",a.status,{shouldValidate:!0}),a&&k(a.roles))},[a]);const t=async x=>{if(n){const y={...x,id_edit:a._id,roles:l};await n(y),g()}};let d=[];const C=(x,y)=>{d=l,y.length>0&&y.forEach(q=>{let P=d.findIndex(R=>R===q);P!==-1&&d.splice(P,1)}),d=d.concat(x),d=Array.from(new Set(d)),k(d)};return e.jsx(e.Fragment,{children:e.jsxs(se,{maxWidth:"lg",fullWidth:!0,disableEscapeKeyDown:!0,onClose:(x,y)=>{y!=="backdropClick"&&g(x,y)},open:c,TransitionComponent:ke,keepMounted:!0,"aria-describedby":"alert-dialog-slide-description",children:[e.jsxs(te,{style:{display:"flex",borderBottom:"1px solid #ccc",backgroundColor:"rgb(30, 41, 59 )",margin:"0px"},children:[e.jsx(le,{style:{color:"white",fontSize:"24px",marginRight:"8px"}}),e.jsx("span",{className:"text-white text-[18px]",children:"Chỉnh sửa nhóm quyền"}),e.jsx(Ce,{onClick:()=>g(),children:e.jsx(oe,{style:{color:"white"}})})]}),e.jsx(re,{children:e.jsx(A,{children:e.jsxs("form",{className:"mt-2 mx-8",onSubmit:o(t),children:[e.jsxs("div",{className:"flex-col flex",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Tên nhóm quyền: "]}),e.jsx("input",{...h("tennhom",{required:!0}),type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex-col flex",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Mô tả nhóm quyền: "]}),e.jsx("input",{...h("mota",{required:!0}),type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Thứ tự xuất hiện: "]}),e.jsx("input",{...h("thutu",{required:!0}),type:"number",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsx("label",{className:"underline font-semibold",children:"Trạng thái hiển thị:"}),e.jsx(H,{name:"status",control:f,render:({field:{value:x,onChange:y}})=>e.jsx(I,{checked:x,onChange:y})})]})]}),e.jsx("div",{children:e.jsxs("div",{className:"flex flex-col lg:flex-row flex-wrap",children:[e.jsx(m,{label:"Quản trị tài khoản",values:[{name:"xem tài khoản"},{name:"thêm tài khoản"},{name:"sửa tài khoản"},{name:"xóa tài khoản"}],onChangeRoleList:C,roleNow:l}),e.jsx(m,{label:"Quản trị nhóm quyền",values:[{name:"xem nhóm quyền"},{name:"thêm nhóm quyền"},{name:"sửa nhóm quyền"},{name:"xóa nhóm quyền"}],onChangeRoleList:C,roleNow:l}),e.jsx(m,{label:"Quản trị mô hình tổ chức",values:[{name:"xem mô hình tổ chức"},{name:"thêm mô hình tổ chức"},{name:"sửa mô hình tổ chức"},{name:"xóa mô hình tổ chức"}],onChangeRoleList:C,roleNow:l}),e.jsx(m,{label:"Quản trị chức vụ",values:[{name:"xem chức vụ"},{name:"thêm chức vụ"},{name:"sửa chức vụ"},{name:"xóa chức vụ"}],onChangeRoleList:C,roleNow:l}),e.jsx(m,{label:"Quản trị bậc hàm",values:[{name:"xem bậc hàm"},{name:"thêm bậc hàm"},{name:"sửa bậc hàm"},{name:"xóa bậc hàm"}],onChangeRoleList:C,roleNow:l}),e.jsx(m,{label:"Quản trị thông báo",values:[{name:"xem thông báo"},{name:"thêm thông báo"},{name:"sửa thông báo"},{name:"xóa thông báo"}],onChangeRoleList:C,roleNow:l}),e.jsx(m,{label:"Quản trị đoàn viên",values:[{name:"xem đoàn viên"},{name:"thêm đoàn viên"},{name:"sửa đoàn viên"},{name:"xóa đoàn viên"},{name:"thay-doi-truong-thanh-doan"}],onChangeRoleList:C,roleNow:l}),e.jsx(m,{label:"Quản trị khen thưởng, kỉ luật",values:[{name:"xem khen thưởng, kỉ luật"},{name:"thêm khen thưởng, kỉ luật"},{name:"sửa khen thưởng, kỉ luật"},{name:"xóa khen thưởng, kỉ luật"},{name:"thêm thi đua"}],onChangeRoleList:C,roleNow:l}),e.jsx(m,{label:"Thống kê, báo cáo",values:[{name:"xem thống kê"},{name:"thống kê khen thưởng"},{name:"thống kê thi đua"},{name:"thống kê trưởng thành đoàn"}],onChangeRoleList:C,roleNow:l}),e.jsx(m,{label:"Quản trị nâng cao",values:[{name:"xem nâng cao"},{name:"thêm nâng cao"},{name:"sửa nâng cao"},{name:"xóa nâng cao"},{name:"xem phân hệ admin"}],onChangeRoleList:C,roleNow:l})]})}),e.jsx(ie,{children:e.jsxs(S,{color:"primary",variant:"contained",type:"submit",style:{margin:"4px auto"},children:[e.jsx(V,{}),e.jsx("span",{children:"Cập nhật"})]})})]})})})]})})}const Ee=()=>{const[c,a]=b.useState([]),[g,n]=X();Y(),b.useState([]);const[h,o]=b.useState({status:!1,item:null}),f=()=>{o({...h,status:!1})},s=u=>{o({item:u,status:!0})},[r,j]=b.useState({status:!1,id_Delete:null}),i=u=>{j({status:!0,id_Delete:u})},l=()=>{j({...r,status:!1})},k=()=>{j({...r,status:!1})};let t=[];const[d,C]=b.useState([]),x=(u,v)=>{t=d,v.length>0&&v.forEach(N=>{let _=t.findIndex(U=>U===N);_!==-1&&t.splice(_,1)}),t=t.concat(u),t=Array.from(new Set(t)),C(t)},{register:y,handleSubmit:q,control:P,resetField:R,watch:ve,formState:{errors:Ne}}=F({defaultValues:{tennhom:"",thutu:1,mota:"",roles:[],status:!0}});b.useEffect(()=>{(async()=>{try{n(!0);let v=await D.getRoles();a(v.data),setTimeout(()=>{n(!1)},400)}catch(v){console.log(v.message)}})()},[]);const K=async u=>{let v={...u,roles:d};n(!0);try{let N=await D.addRole(v);a(N.data.rolesList),setTimeout(()=>{n(!1)},400),R("tennhom"),R("mota"),R("status"),R("thutu"),C([]),w.success(N.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}catch(N){w.error(N.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),n(!1)}},G=async u=>{let v={...u};n(!0);try{let N=await D.editRole(v);a(N.data.rolesList),setTimeout(()=>{n(!1)},400),w.success(N.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}catch(N){w.error(N.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),n(!1)}},J=async()=>{n(!0);try{let u=await D.deleteRole(r.id_Delete);a(u.data.rolesList),setTimeout(()=>{n(!1)},400),j({...r,status:!1}),w.success(u.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}catch(u){j({...r,status:!1}),w.error(u.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),n(!1)}},O=M(u=>u.authReducer.roles_quanlydoanvien);return e.jsxs("div",{className:"pr-2","data-aos":"fade-left","data-aos-once":"true",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Z,{color:"primary",fontSize:"large"}),e.jsx("h4",{className:"font-bold text-gray-800 text-lg",children:"Quản lý nhóm quyền"})]}),O&&O.includes("thêm nhóm quyền")&&e.jsxs("form",{className:"mt-2 mx-8",onSubmit:q(K),children:[e.jsxs("div",{className:"flex-col flex",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Tên nhóm quyền: "]}),e.jsx("input",{...y("tennhom",{required:!0}),type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex-col flex",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Mô tả nhóm quyền: "]}),e.jsx("input",{...y("mota",{required:!0}),type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Thứ tự xuất hiện: "]}),e.jsx("input",{...y("thutu",{required:!0}),type:"number",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsx("label",{className:"underline font-semibold",children:"Trạng thái sử dụng:"}),e.jsx(H,{name:"status",control:P,render:({field:{value:u,onChange:v}})=>e.jsx(I,{checked:u,onChange:v})})]})]}),e.jsx("div",{children:e.jsxs("div",{className:"flex flex-col lg:flex-row flex-wrap",children:[e.jsx(m,{label:"Quản trị tài khoản",values:[{name:"xem tài khoản"},{name:"thêm tài khoản"},{name:"sửa tài khoản"},{name:"xóa tài khoản"}],onChangeRoleList:x,roleNow:d}),e.jsx(m,{label:"Quản trị nhóm quyền",values:[{name:"xem nhóm quyền"},{name:"thêm nhóm quyền"},{name:"sửa nhóm quyền"},{name:"xóa nhóm quyền"}],onChangeRoleList:x,roleNow:d}),e.jsx(m,{label:"Quản trị mô hình tổ chức",values:[{name:"xem mô hình tổ chức"},{name:"thêm mô hình tổ chức"},{name:"sửa mô hình tổ chức"},{name:"xóa mô hình tổ chức"}],onChangeRoleList:x,roleNow:d}),e.jsx(m,{label:"Quản trị chức vụ",values:[{name:"xem chức vụ"},{name:"thêm chức vụ"},{name:"sửa chức vụ"},{name:"xóa chức vụ"}],onChangeRoleList:x,roleNow:d}),e.jsx(m,{label:"Quản trị bậc hàm",values:[{name:"xem bậc hàm"},{name:"thêm bậc hàm"},{name:"sửa bậc hàm"},{name:"xóa bậc hàm"}],onChangeRoleList:x,roleNow:d}),e.jsx(m,{label:"Quản trị thông báo",values:[{name:"xem thông báo"},{name:"thêm thông báo"},{name:"sửa thông báo"},{name:"xóa thông báo"}],onChangeRoleList:x,roleNow:d}),e.jsx(m,{label:"Quản trị đoàn viên",values:[{name:"xem đoàn viên"},{name:"thêm đoàn viên"},{name:"sửa đoàn viên"},{name:"xóa đoàn viên"},{name:"thay-doi-truong-thanh-doan"}],onChangeRoleList:x,roleNow:d}),e.jsx(m,{label:"Quản trị khen thưởng, kỉ luật",values:[{name:"xem khen thưởng, kỉ luật"},{name:"thêm khen thưởng, kỉ luật"},{name:"sửa khen thưởng, kỉ luật"},{name:"xóa khen thưởng, kỉ luật"},{name:"thêm thi đua"}],onChangeRoleList:x,roleNow:d}),e.jsx(m,{label:"Thống kê, báo cáo",values:[{name:"xem thống kê"},{name:"thống kê khen thưởng"},{name:"thống kê thi đua"},{name:"thống kê trưởng thành đoàn"}],onChangeRoleList:x,roleNow:d}),e.jsx(m,{label:"Quản trị nâng cao",values:[{name:"xem nâng cao"},{name:"thêm nâng cao"},{name:"sửa nâng cao"},{name:"xóa nâng cao"}],onChangeRoleList:x,roleNow:d})]})}),e.jsx("div",{className:"md:space-x-2 space-y-2 md:space-y-0 md:block flex flex-col items-center",children:e.jsxs(S,{type:"submit",sx:{width:"220px",backgroundColor:"gray"},color:"primary",variant:"contained",children:[e.jsx(V,{})," Thêm mới"]})})]}),e.jsx("div",{className:"mt-6 mx-8",children:e.jsx(je,{list:c,onClickOpenDialogDelete:i,onClickOpenDialogEdit:s})}),e.jsx(ye,{open:h.status,item:h.item,onCloseDialogEdit:f,onSubmit:G}),e.jsx(ce,{open:r.status,onCloseDialogDelete:k,onConfirmDelete:J,onCancelDelete:l})]})};export{Ee as default};
