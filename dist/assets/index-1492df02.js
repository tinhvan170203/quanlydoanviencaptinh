import{r,k as $,m as z,u as I,d as M,j as e,Q as n}from"./index-2b00a054.js";import{d as Q}from"./GridView-85d728d6.js";import"./index.esm-a80e06b2.js";import{u as R,C as V}from"./index.esm-322da860.js";import{d as A}from"./Close-7c89c175.js";import{d as N}from"./Search-c2bf7f37.js";import{d as L}from"./Add-84462153.js";import{q as G}from"./base-e8aaf39e.js";import{T as J,E as K,n as m}from"./EditModal-7fa1e8ef.js";import{e as U}from"./DialogDelete-f919c647.js";import{S as W}from"./Switch-39e410f5.js";import{B as g}from"./Button-c283a03a.js";import{I as X}from"./LastPage-e02fc572.js";import"./createSvgIcon-46c59fe3.js";import"./ButtonBase-ca61bcf9.js";const pe=()=>{const[y,p]=r.useState(!1),[x,v]=r.useState(""),[D,d]=r.useState([]);let[Y,k]=$();const[u,s]=z();I();const i=r.useMemo(()=>{const t=G.parse(location.search);return{...t,thongbao:t.thongbao||""}},[location.search]),[h,b]=r.useState({status:!1,item:null}),S=()=>{b({...h,status:!1})},O=t=>{b({item:t,status:!0})},[l,c]=r.useState({status:!1,id_Delete:null}),w=t=>{c({status:!0,id_Delete:t})},E=()=>{c({...l,status:!1})},T=()=>{c({...l,status:!1})},{register:j,handleSubmit:P,control:B,resetField:f,watch:Z,formState:{errors:ee}}=R({defaultValues:{thongbao:"",thutu:1,status:!0}}),_=t=>{t.preventDefault(),k({...i,thongbao:x})};r.useEffect(()=>{(async()=>{try{s(!0);let o=await m.getNotifications(i);d(o.data),u(o.data),setTimeout(()=>{s(!1)},400)}catch{}})()},[i]);const q=async t=>{let o={...t,queryParams:i};s(!0);try{let a=await m.addNotification(o);d(a.data.notifications),u(a.data.notifications),setTimeout(()=>{s(!1)},400),f("thongbao"),f("thutu"),f("status"),n.success(a.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}catch(a){n.error(a.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),s(!1)}},H=async t=>{let o={...t,queryParams:i};s(!0);try{let a=await m.editNotification(o);d(a.data.notifications),u(a.data.notifications),setTimeout(()=>{s(!1)},400),n.success(a.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}catch(a){n.error(a.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),s(!1)}},F=async()=>{s(!0);try{let t=await m.deleteNotification(l.id_Delete,{...i});d(t.data.notifications),u(t.data.notifications),setTimeout(()=>{s(!1)},400),c({...l,status:!1}),n.success(t.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}catch(t){c({...l,status:!1}),n.error(t.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),s(!1)}},C=M(t=>t.authReducer.roles_quanlydoanvien);return e.jsxs("div",{className:"pr-2","data-aos":"fade-left","data-aos-once":"true",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Q,{color:"primary",fontSize:"large"}),e.jsx("h4",{className:"font-bold text-gray-800 text-lg",children:"Quản lý thanh thông báo"})]}),C&&C.includes("thêm thông báo")&&e.jsxs("form",{className:"mt-2 mx-8",onSubmit:P(q),children:[e.jsxs("div",{className:"flex-col flex",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Nội dung thông báo mới: "]}),e.jsx("input",{...j("thongbao",{required:!0}),type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Thứ tự xuất hiện: "]}),e.jsx("input",{...j("thutu",{required:!0}),type:"number",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsx("label",{className:"underline font-semibold",children:"Trạng thái hiển thị:"}),e.jsx(V,{name:"status",control:B,render:({field:{value:t,onChange:o}})=>e.jsx(W,{checked:t,onChange:o})})]})]}),e.jsxs("div",{className:"md:space-x-2 space-y-2 md:space-y-0 md:block flex flex-col items-center",children:[e.jsxs(g,{type:"submit",sx:{width:"220px",backgroundColor:"gray"},color:"primary",variant:"contained",children:[e.jsx(L,{})," Thêm mới"]}),e.jsxs(g,{sx:{width:"220px",backgroundColor:"darkgray"},onClick:()=>p(!0),color:"info",variant:"contained",children:[e.jsx(N,{})," Chức năng tìm kiếm"]})]})]}),y&&e.jsxs("form",{onSubmit:t=>_(t),className:"my-2 mt-4 mx-8 bg-slate-800 p-4 rounded-lg shadow-xl","data-aos":"zoom-in-down","data-aos-once":"true",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("h5",{className:"text-white text-[18px] font-semibold",children:"Tìm kiếm thông báo"}),e.jsx(X,{onClick:()=>p(!1),sx:{backgroundColor:"#ccc"},children:e.jsx(A,{sx:{color:"white"}})})]}),e.jsx("div",{className:"flex space-x-4 mt-2",children:e.jsx("div",{className:"flex-col flex flex-1",children:e.jsx("input",{type:"text",defaultValue:x,className:`outline-none my-2 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:ring-white focus:border-white`,onChange:t=>v(t.target.value),placeholder:"Nội dung thông báo"})})}),e.jsx("div",{className:"my-2 text-center",children:e.jsxs(g,{sx:{width:"200px",backgroundColor:"slategray"},type:"submit",color:"info",variant:"contained",children:[e.jsx(N,{})," Tìm kiếm"]})})]}),e.jsx("div",{className:"mt-6 mx-8",children:e.jsx(J,{list:D,onClickOpenDialogDelete:w,onClickOpenDialogEdit:O})}),e.jsx(K,{open:h.status,item:h.item,onCloseDialogEdit:S,onSubmit:H}),e.jsx(U,{open:l.status,onCloseDialogDelete:T,onConfirmDelete:F,onCancelDelete:E})]})};export{pe as default};
