import{r as p,j as e,d as I,k as Q,m as G,u as J,Q as k}from"./index-2b00a054.js";import{d as U}from"./GridView-85d728d6.js";import"./index.esm-a80e06b2.js";import{u as E,C}from"./index.esm-322da860.js";import{d as K}from"./Add-84462153.js";import{S as X,D as Y,a as Z,h as ee,d as se,b as te,c as ae,f as le,g as re,e as ne}from"./DialogDelete-f919c647.js";import{S as V}from"./react-select.esm-a86401bf.js";import{I as D,a as M,c as O,d as i,e as S,f as ie,P as oe,h as de,i as ce,j as ue,k as he,u as xe,l as R,m as z,n as $,o as q}from"./LastPage-e02fc572.js";import{S as T}from"./Switch-39e410f5.js";import{B as b}from"./Button-c283a03a.js";import{s as me}from"./ButtonBase-ca61bcf9.js";import{d as P}from"./donviApi-468d849b.js";import{k as fe}from"./khoiApi-acbe0036.js";import"./createSvgIcon-46c59fe3.js";const ge=p.forwardRef(function(a,o){return e.jsx(X,{direction:"up",ref:o,...a})}),pe=me(D)({position:"absolute",right:"16px",top:"4px"});function be({open:l,item:a,onCloseDialogEdit:o,onSubmit:r,khois:x}){const{register:s,handleSubmit:d,control:u,resetField:j,watch:v,setValue:t,formState:{errors:h}}=E({defaultValues:{tendonvi:"",kyhieu:"",khoi:"",thutu:1,trangthai:!0,status:!0}});p.useEffect(()=>{a&&(t("tendonvi",a.tendonvi,{shouldValidate:!0}),t("kyhieu",a.kyhieu,{shouldValidate:!0}),t("thutu",a.thutu,{shouldValidate:!0}),t("status",a.status,{shouldValidate:!0}),t("trangthai",a.trangthai,{shouldValidate:!0}),t("khoi",{value:a.khoi._id,label:a.khoi.tenkhoi},{shouldValidate:!0}))},[a]);const y=async c=>{if(r){const f={...c,id_edit:a._id};await r(f),o()}};return e.jsx(e.Fragment,{children:e.jsxs(Y,{maxWidth:"lg",fullWidth:!0,disableEscapeKeyDown:!0,onClose:(c,f)=>{f!=="backdropClick"&&o(c,f)},open:l,TransitionComponent:ge,keepMounted:!0,"aria-describedby":"alert-dialog-slide-description",children:[e.jsxs(Z,{style:{display:"flex",borderBottom:"1px solid #ccc",backgroundColor:"rgb(30, 41, 59 )",margin:"0px"},children:[e.jsx(ee,{style:{color:"white",fontSize:"24px",marginRight:"8px"}}),e.jsx("span",{className:"text-white text-[18px]",children:"Chỉnh sửa khối, hệ, lực lượng"}),e.jsx(pe,{onClick:()=>o(),children:e.jsx(se,{style:{color:"white"}})})]}),e.jsx(te,{children:e.jsx(M,{children:e.jsxs("form",{className:"mt-2 mx-8",onSubmit:d(y),children:[e.jsxs("div",{className:"flex-col flex",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Tên đơn vị: "]}),e.jsx("input",{...s("tendonvi",{required:!0}),type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex-col flex",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Ký hiệu đơn vị: "]}),e.jsx("input",{...s("kyhieu",{required:!0}),type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Thứ tự: "]}),e.jsx("input",{...s("thutu",{required:!0}),type:"number",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex-col flex md:basis-1/4",children:[e.jsx("label",{className:"underline font-semibold",children:"Đơn vị trực thuộc Công an tỉnh:"}),e.jsx(C,{name:"status",control:u,render:({field:{value:c,onChange:f}})=>e.jsx(T,{checked:c,onChange:f})})]}),e.jsxs("div",{className:"flex-col flex md:basis-1/4",children:[e.jsx("label",{className:"underline font-semibold",children:"Trạng thái:"}),e.jsx(C,{name:"trangthai",control:u,render:({field:{value:c,onChange:f}})=>e.jsx(T,{checked:c,onChange:f})})]})]}),e.jsxs("div",{className:"flex-col flex",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Khối, hệ, lực lượng: "]}),e.jsx(C,{control:u,name:"khoi",render:({field:c})=>e.jsx(V,{required:!0,name:"khoi",options:x,className:"basic-multi-select my-4",classNamePrefix:"select",...c})})]}),e.jsx(ae,{children:e.jsxs(b,{color:"primary",variant:"contained",type:"submit",style:{margin:"4px auto"},children:[e.jsx(K,{}),e.jsx("span",{children:"Cập nhật"})]})})]})})})]})})}const je=({row:l,page:a,rowsPerPage:o,index:r,onClickOpenDialogEdit:x,onClickOpenDialogDelete:s})=>{p.useState(null);const d=I(u=>u.authReducer.roles_quanlydoanvien);return e.jsxs(O,{className:"hover:bg-slate-200 transition duration-300",children:[e.jsx(i,{className:"border-r border-slate-300",align:"left",style:{fontWeight:"bold"},children:a*o+r}),e.jsx(i,{className:"border-r border-slate-300",align:"left",children:l.tendonvi}),e.jsx(i,{className:"border-r border-slate-300",align:"left",children:l.kyhieu}),e.jsx(i,{className:"border-r border-slate-300",align:"left",children:l.khoi.tenkhoi}),e.jsx(i,{className:"border-r border-slate-300",align:"left",children:l.thutu}),e.jsx(i,{className:"border-r border-slate-300",align:"left",children:l.status===!0?e.jsx(b,{color:"success",children:"Có"}):e.jsx(b,{color:"warning",children:"Không"})}),e.jsx(i,{className:"border-r border-slate-300",align:"left",children:l.trangthai===!0?e.jsx(b,{color:"success",children:"Active"}):e.jsx(b,{color:"warning",children:"None Active"})}),e.jsxs(i,{align:"right",className:"bg-gray-300 flex justify-center items-center space-x-1 hover:bg-slate-500 transition duration-300",style:{width:"180px"},children:[d&&d.includes("sửa mô hình tổ chức")&&e.jsx(b,{variant:"contained",color:"info",size:"small",onClick:()=>x(l),children:e.jsx(le,{style:{fontSize:"20px"}})}),d&&d.includes("xóa mô hình tổ chức")&&e.jsx(b,{variant:"contained",color:"error",size:"small",style:{marginLeft:"4px"},onClick:()=>s(l._id),children:e.jsx(re,{style:{fontSize:"20px"}})})]})]},l._id)};function A(l){const a=xe(),{count:o,page:r,rowsPerPage:x,onPageChange:s}=l,d=t=>{s(t,0)},u=t=>{s(t,r-1)},j=t=>{s(t,r+1)},v=t=>{s(t,Math.max(0,Math.ceil(o/x)-1))};return e.jsxs(M,{sx:{flexShrink:0,ml:2.5},children:[e.jsx(D,{onClick:d,disabled:r===0,"aria-label":"first page",children:a.direction==="rtl"?e.jsx(R,{}):e.jsx(z,{})}),e.jsx(D,{onClick:u,disabled:r===0,"aria-label":"previous page",children:a.direction==="rtl"?e.jsx($,{}):e.jsx(q,{})}),e.jsx(D,{onClick:j,disabled:r>=Math.ceil(o/x)-1,"aria-label":"next page",children:a.direction==="rtl"?e.jsx(q,{}):e.jsx($,{})}),e.jsx(D,{onClick:v,disabled:r>=Math.ceil(o/x)-1,"aria-label":"last page",children:a.direction==="rtl"?e.jsx(z,{}):e.jsx(R,{})})]})}A.propTypes={count:S.number.isRequired,onPageChange:S.func.isRequired,page:S.number.isRequired,rowsPerPage:S.number.isRequired};function ve({list:l,onClickOpenDialogEdit:a,onClickOpenDialogDelete:o}){const[r,x]=p.useState(0),[s,d]=p.useState(10),u=r>0?Math.max(0,(1+r)*s-l.length):0,j=(t,h)=>{x(h)},v=t=>{d(parseInt(t.target.value,10)),x(0)};return e.jsxs(e.Fragment,{children:[e.jsx(ie,{component:oe,children:e.jsxs(de,{"aria-label":"custom pagination table",children:[e.jsx(ce,{children:e.jsxs(O,{children:[e.jsx(i,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(30, 41, 59 )"},children:"#"}),e.jsx(i,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(30, 41, 59 )"},children:"Tên đơn vị"}),e.jsx(i,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(30, 41, 59 )"},children:"Ký hiệu"}),e.jsx(i,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(30, 41, 59 )"},children:"Khối"}),e.jsx(i,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"100px",backgroundColor:"rgb(30, 41, 59 )"},children:"Thứ tự"}),e.jsx(i,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"200px",backgroundColor:"rgb(30, 41, 59 )"},children:"Trực thuộc Công an tỉnh"}),e.jsx(i,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",minWidth:"200px",backgroundColor:"rgb(30, 41, 59 )"},children:"Trạng thái"}),e.jsx(i,{align:"center",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"rgb(30, 41, 59 )",maxWidth:"150px"},children:"Thao tác"})]})}),e.jsxs(ue,{children:[(s>0?l.slice(r*s,r*s+s):l).map((t,h)=>e.jsx(je,{row:t,page:r,rowsPerPage:s,index:h+1,onClickOpenDialogEdit:a,onClickOpenDialogDelete:o},t._id)),u>0&&e.jsx(O,{style:{height:53*u},children:e.jsx(i,{colSpan:6})})]})]})}),e.jsx("div",{children:e.jsx(he,{rowsPerPageOptions:[10,25,50,100,{label:"Tất cả",value:-1}],count:l.length,rowsPerPage:s,page:r,SelectProps:{inputProps:{"aria-label":"rows per page"},native:!0},component:"div",onPageChange:j,onRowsPerPageChange:v,ActionsComponent:A,labelRowsPerPage:"Số bản ghi hiển thị trên mỗi trang",labelDisplayedRows:function({from:h,to:y,count:c}){return`hiển thị ${h} đến ${y} bản ghi trong tổng số ${c!==-1?c:`more than ${y}`} bản ghi`}})})]})}const Ee=()=>{Q();const[l,a]=p.useState([]),[o,r]=p.useState([]),[x,s]=G();J();const[d,u]=p.useState({status:!1,item:null}),j=()=>{u({...d,status:!1})},v=n=>{u({item:n,status:!0})},[t,h]=p.useState({status:!1,id_Delete:null}),y=n=>{h({status:!0,id_Delete:n})},c=()=>{h({...t,status:!1})},f=()=>{h({...t,status:!1})},{register:w,handleSubmit:F,control:_,resetField:N,watch:ye,formState:{errors:ke}}=E({defaultValues:{tendonvi:"",kyhieu:"",khoi:"",trangthai:!0,thutu:1,status:!0}});p.useEffect(()=>{(async()=>{try{s(!0);let g=await P.getDonvis(),m=await fe.getKhois();a(g.data),r(m.data.map(B=>({value:B._id,label:B.tenkhoi}))),setTimeout(()=>{s(!1)},400)}catch{}})()},[]);const H=async n=>{let g={...n};s(!0);try{let m=await P.addDonvi(g);a(m.data.donvis),setTimeout(()=>{s(!1)},400),N("tendonvi"),N("kyhieu"),N("thutu"),N("khoi"),N("status"),k.success(m.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}catch(m){k.error(m.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),s(!1)}},W=async n=>{let g={...n};s(!0);try{let m=await P.editDonvi(g);a(m.data.donvis),setTimeout(()=>{s(!1)},400),k.success(m.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}catch(m){k.error(m.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),s(!1)}},L=async()=>{s(!0);try{let n=await P.deleteDonvi(t.id_Delete);a(n.data.donvis),setTimeout(()=>{s(!1)},400),h({...t,status:!1}),k.success(n.data.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}catch(n){h({...t,status:!1}),k.error(n.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),s(!1)}};return e.jsxs("div",{className:"pr-2","data-aos":"fade-left","data-aos-once":"true",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(U,{color:"primary",fontSize:"large"}),e.jsx("h4",{className:"font-bold text-gray-800 text-lg",children:"Quản lý đơn vị cấp phòng, huyện, thị xã, thành phố"})]}),e.jsxs("form",{className:"mt-2 mx-8",onSubmit:F(H),children:[e.jsxs("div",{className:"flex-col flex",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Tên đơn vị: "]}),e.jsx("input",{...w("tendonvi",{required:!0}),type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex-col flex",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Ký hiệu đơn vị: "]}),e.jsx("input",{...w("kyhieu",{required:!0}),type:"text",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("div",{className:"flex-col flex md:basis-1/3",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Thứ tự: "]}),e.jsx("input",{...w("thutu",{required:!0}),type:"number",className:`outline-none my-4 border rounded-md p-2 border-neutral-600\r
                  focus:ring-2 focus:border-blue-400`})]}),e.jsxs("div",{className:"flex-col flex md:basis-1/3",children:[e.jsx("label",{className:"underline font-semibold",children:"Đơn vị trực thuộc Công an tỉnh:"}),e.jsx(C,{name:"status",control:_,render:({field:{value:n,onChange:g}})=>e.jsx(T,{checked:n,onChange:g})})]}),e.jsxs("div",{className:"flex-col flex md:basis-1/2",children:[e.jsx("label",{className:"underline font-semibold",children:"Trạng thái hoạt động:"}),e.jsx(C,{name:"trangthai",control:_,render:({field:{value:n,onChange:g}})=>e.jsx(T,{checked:n,onChange:g})})]})]}),e.jsxs("div",{className:"flex-col flex",children:[e.jsxs("label",{className:"underline font-semibold",children:[e.jsx("span",{className:"text-red-600 font-semibold",children:" (*)"})," Khối, hệ, lực lượng: "]}),e.jsx(C,{control:_,name:"khoi",render:({field:n})=>e.jsx(V,{required:!0,name:"khoi",options:o,className:"basic-multi-select my-4",classNamePrefix:"select",...n})})]}),e.jsx("div",{className:"md:space-x-2 space-y-2 md:space-y-0 md:block flex flex-col items-center",children:e.jsxs(b,{type:"submit",sx:{width:"220px",backgroundColor:"gray"},color:"primary",variant:"contained",children:[e.jsx(K,{})," Thêm mới"]})})]}),e.jsx("div",{className:"mt-6 mx-8",children:e.jsx(ve,{list:l,onClickOpenDialogDelete:y,onClickOpenDialogEdit:v})}),e.jsx(be,{open:d.status,item:d.item,onCloseDialogEdit:j,onSubmit:W,khois:o}),e.jsx(ne,{open:t.status,onCloseDialogDelete:f,onConfirmDelete:L,onCancelDelete:c})]})};export{Ee as default};
